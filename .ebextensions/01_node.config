# Elastic Beanstalk Configuration
# This file configures the Node.js environment for the Zoom Participant Randomizer

option_settings:
  # Node.js platform settings
  aws:elasticbeanstalk:container:nodejs:
    NodeCommand: "npm start"

  # Environment type - Single instance (no load balancer)
  # Reason: Cost-effective for internal org tool, sessions work without Redis
  aws:elasticbeanstalk:environment:
    EnvironmentType: SingleInstance
    ServiceRole: aws-elasticbeanstalk-service-role

  # Instance configuration
  # t3.micro is free tier eligible for first 12 months
  aws:autoscaling:launchconfiguration:
    InstanceType: t3.micro
    IamInstanceProfile: aws-elasticbeanstalk-ec2-role

  # Health check configuration
  # Uses our /api/health endpoint to verify app is running
  aws:elasticbeanstalk:environment:process:default:
    HealthCheckPath: /api/health
    MatcherHTTPCode: 200

  # Application environment
  aws:elasticbeanstalk:application:environment:
    NODE_ENV: production
    PORT: 8080

  # Enhanced health reporting
  aws:elasticbeanstalk:healthreporting:system:
    SystemType: enhanced

  # CloudWatch logs - stream application logs
  aws:elasticbeanstalk:cloudwatch:logs:
    StreamLogs: true
    DeleteOnTerminate: false
    RetentionInDays: 30
